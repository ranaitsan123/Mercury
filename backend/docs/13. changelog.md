# Mercury Backend – Changelog (`changelog.md`)

This document tracks all notable changes made to the Mercury backend system, including features, bug fixes, improvements, and breaking changes.

---

## [1.2.0] – 2025-12-21
### Added
- GraphQL Subscriptions for `emailCreated` and `scanCompleted` events
- Redis integration for real-time updates
- Automatic email scanning for all sent and received emails
- `ScanLog` model tracking scan results with `confidence` and `malicious/safe` status
- Middleware:
  - `SecurityGatewayMiddleware` – adds trace IDs
  - `IntelligentServiceRouterMiddleware` – routes to mock or real services
  - `ResponseLoggingMiddleware` – injects trace IDs in responses
  - `ApiKeyGateMiddleware` – protects sensitive endpoints

### Changed
- Email sending mutations now automatically store emails in `sent` folder
- Scanner mutations now create `ScanLog` automatically
- GraphQL queries require `@login_required` or `@admin_required` decorators as appropriate

### Fixed
- Corrected email mock sending response formatting
- Fixed scan log retrieval with pagination and filtering
- Resolved user authentication issues for GraphQL API

---

## [1.1.0] – 2025-11-15
### Added
- Initial GraphQL API for emails and scanner
- Mutations:
  - `sendEmail` (manual mock or real routing)
  - `scanEmail` (manual scan)
- Queries:
  - `myEmails` (user inbox)
  - `myScanLogs` (user-specific logs)
  - `scanLogs` (admin view)
- Basic email and scanner mock services
- Unit tests for email sending and scanning

### Changed
- Project structured with `emails/`, `scanner/`, `middleware/`, and `users/` apps
- JWT authentication implemented
- Default service routing to `mock` in development

---

## [1.0.0] – 2025-10-10
### Added
- Initial project setup
- PostgreSQL database integration
- User authentication (JWT)
- Basic email model (`Email`)
- Basic scanner model (`ScanLog`)
- `pytest` test suite with middleware, routing, users, emails, scanner tests
- Documentation placeholders for backend concepts (`docs/` folder)

---

## Notes
- Versioning follows **Semantic Versioning (SemVer)**: `MAJOR.MINOR.PATCH`
- All changes are backwards compatible unless explicitly marked as breaking
- Future updates will include improvements to GraphQL subscriptions and frontend integration

---

